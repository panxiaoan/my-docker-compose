services:
  postgres18:
    image: postgres:18.0-alpine3.22 # https://github.com/docker-library/docs/blob/master/postgres/README.md
    container_name: postgres18
    hostname: postgres18
    # network_mode: host # 设置网络模式为主机模式(端口映射无效)
    restart: always # always | no | on-failure
    privileged: false
    ports:
      - 54321:5432
    shm_size: 300MB
    command: >
      -c shared_buffers=256MB
      -c effective_cache_size=1GB
      -c work_mem=16MB
      -c fsync=off
      -c synchronous_commit=off
    environment:
      - TZ=Asia/Shanghai
      - POSTGRES_DB=postgres
      - POSTGRES_USER=root
      - POSTGRES_PASSWORD=1qaz<LP_
      - POSTGRES_INITDB_ARGS=--encoding=UTF8 --locale=C.UTF-8
      - PGDATA=/var/lib/postgresql/18/docker
    volumes:
      - ../../my-docker-volumes/postgres18/data:/var/lib/postgresql/18/docker
    logging:
      driver: "json-file"
      options:
        max-size: "20m"
        max-file: "3"
    networks:
      default: 
        aliases:
          - postgres18_net
networks:
  default:
    name: docker_default_net
    external: true